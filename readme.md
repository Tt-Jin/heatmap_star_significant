# 热图+显著性星号标记

#### 1. 数据

- 这是对数转换后的数据

- 最后一列是显著性信息

#### 2. 定义因子顺序

- 使用 factor() 函数先定义好各列因子的顺序，防止绘图时按照默认首字母排序排乱了，里面 levels = data$Bile Acides 意思是按原数据顺序排序。

- 因为 y 轴（基因）默认顺序是从下往上，所以按照原数据的顺序我们还需用 rev() 函数倒转一下，才能和 Figure 里顺序一致。

#### 3. 绘图

- geom_tile(aes(fill = Fold Change)) 使得Fold Change值映射到热图的颜色上
- scale_fill_gradientn() 函数用于自定义渐变色，colours = c("#6FCFCF", "white", "#DD6048") 指定了颜色的范围，values = c(0, 0.15, 1) 是用来调整三个颜色的比例，原文中有大量数据集中在一个较小的区间内，其对应的颜色会相对稀释的很浅，所以要调一下颜色比例，这样才能凸显较小区间的颜色。
- scale_y_discrete() 函数用于设置Y轴的刻度，通过 limits 参数添加一个空白行
- geom_rect() 函数是添加一个矩形框，因为添加了一个空白行，这会使图形会分成两部分，所以这里添加一个框，将两部分框在一起。
- scale_x_discrete() 函数使图形通过原点
- geom_text(aes(label = sig) 根据显著性值添加星号标记，并根据Fold Change的正负设置星号的颜色。
- 使用 ggdraw() 函数创建一个空白的ggplot对象，再用 draw_label() 函数在空白图上添加文本标签，可指定文本内容、位置、角度和大小等。
- plot_grid(anno, p, ncol = 2, rel_widths = c(0.1, 0.9)) 将自定义文本和热图组合在一起，指定列数为2，自定义文本占10%宽度，热图占90%宽度。

#### 

### 最重要的是：

码代码不易，如果你觉得我的教程对你有帮助，请**小红书**(号****Ttian6688**)关注我！！！
